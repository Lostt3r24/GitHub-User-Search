<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub User Search</title>
    <link rel="stylesheet" href="main.css">
    <!-- Можно добавить иконки, например Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fab fa-github"></i> GitHub User Search</h1>
            <p>Найдите любого пользователя GitHub и посмотрите его профиль и репозитории</p>
        </header>

        <main>
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input 
                        type="text" 
                        id="search" 
                        placeholder="Введите имя пользователя GitHub..."
                        autocomplete="off"
                    >
                    <div class="search-clear" id="clearSearch" style="display: none;">
                        <i class="fas fa-times"></i>
                    </div>
                </div>
            </div>

            <!-- Индикатор загрузки -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Ищем пользователя...</p>
            </div>

            <!-- Сообщение об ошибке -->
            <div id="error" class="error-message" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <p id="error-text">Пользователь не найден</p>
            </div>

            <!-- Результаты поиска -->
            <div id="results" class="results" style="display: none;">
                <!-- Карточка пользователя -->
                <div class="user-card">
                    <div class="user-header">
                        <img id="user-avatar" src="" alt="Аватар" class="user-avatar">
                        <div class="user-info">
                            <h2 id="user-name">User Name</h2>
                            <h3 id="user-login" class="user-login">@username</h3>
                            <a id="user-profile" href="#" target="_blank" class="profile-link">
                                <i class="fas fa-external-link-alt"></i>
                                Открыть профиль GitHub
                            </a>
                        </div>
                    </div>
                    
                    <div class="user-stats">
                        <div class="stat">
                            <span class="stat-number" id="repos-count">0</span>
                            <span class="stat-label">Репозитории</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="followers-count">0</span>
                            <span class="stat-label">Подписчики</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="following-count">0</span>
                            <span class="stat-label">Подписки</span>
                        </div>
                    </div>

                    <div class="user-bio">
                        <p id="user-bio">Биография пользователя...</p>
                    </div>
                </div>

                <!-- Секция репозиториев -->
                <div class="repos-section">
                    <h3>Популярные репозитории</h3>
                    <div id="repos-list" class="repos-list">
                        <!-- Репозитории будут добавляться динамически -->
                    </div>
                </div>
            </div>

            <!-- Начальное состояние (до поиска) -->
            <div id="initial-state" class="initial-state">
                <div class="initial-icon">
                    <i class="fab fa-github"></i>
                </div>
                <h2>Начните поиск</h2>
                <p>Введите имя пользователя GitHub в поле выше чтобы увидеть его профиль и репозитории</p>
                <div class="examples">
                    <p>Попробуйте: 
                        <span class="example-user" data-user="gaearon">gaearon</span>, 
                        <span class="example-user" data-user="sindresorhus">sindresorhus</span>, 
                        <span class="example-user" data-user="yyx990803">yyx990803</span>
                    </p>
                </div>
            </div>
        </main>

        <footer>
            <p>Создано с помощью GitHub API</p>
        </footer>
    </div>

    <script>
        // Шаблон для репозитория (можно вынести в отдельный файл)
        function createRepoElement(repo) {
            return `
                <div class="repo-card">
                    <div class="repo-header">
                        <h4>
                            <a href="${repo.html_url}" target="_blank" class="repo-link">
                                ${repo.name}
                            </a>
                        </h4>
                        <div class="repo-stats">
                            <span class="repo-stat">
                                <i class="fas fa-star"></i>
                                ${repo.stargazers_count}
                            </span>
                            ${repo.language ? `
                                <span class="repo-language">
                                    <span class="language-dot"></span>
                                    ${repo.language}
                                </span>
                            ` : ''}
                        </div>
                    </div>
                    ${repo.description ? `
                        <p class="repo-description">${repo.description}</p>
                    ` : ''}
                    <div class="repo-footer">
                        ${repo.updated_at ? `
                            <span class="repo-updated">
                                Обновлен: ${new Date(repo.updated_at).toLocaleDateString('ru-RU')}
                            </span>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // Основной JavaScript код
        document.addEventListener('DOMContentLoaded', function() {
            // Получаем элементы DOM
            const searchInput = document.getElementById('search');
            const clearSearch = document.getElementById('clearSearch');
            const loadingIndicator = document.getElementById('loading');
            const errorMessage = document.getElementById('error');
            const resultsContainer = document.getElementById('results');
            const initialState = document.getElementById('initial-state');
            const reposList = document.getElementById('repos-list');
            
            // Элементы пользователя
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            const userLogin = document.getElementById('user-login');
            const userProfile = document.getElementById('user-profile');
            const userBio = document.getElementById('user-bio');
            const reposCount = document.getElementById('repos-count');
            const followersCount = document.getElementById('followers-count');
            const followingCount = document.getElementById('following-count');

            // Функция debounce
            function debounce(func, timeout = 500) {
                let timer;
                return (...args) => {
                    clearTimeout(timer);
                    timer = setTimeout(() => { func.apply(this, args); }, timeout);
                };
            }

            // Функции для управления UI
            function showLoading() {
                loadingIndicator.style.display = 'block';
                errorMessage.style.display = 'none';
                resultsContainer.style.display = 'none';
                initialState.style.display = 'none';
            }

            function hideLoading() {
                loadingIndicator.style.display = 'none';
            }

            function showError(message) {
                errorMessage.style.display = 'flex';
                document.getElementById('error-text').textContent = message;
                resultsContainer.style.display = 'none';
                initialState.style.display = 'none';
            }

            function showResults() {
                resultsContainer.style.display = 'block';
                errorMessage.style.display = 'none';
                initialState.style.display = 'none';
            }

            function clearResults() {
                resultsContainer.style.display = 'none';
                errorMessage.style.display = 'none';
                reposList.innerHTML = '';
            }

            function showInitialState() {
                initialState.style.display = 'block';
                resultsContainer.style.display = 'none';
                errorMessage.style.display = 'none';
            }

            // Функция для отображения данных пользователя
            function displayUser(user) {
                userAvatar.src = user.avatar_url;
                userAvatar.alt = `${user.login}'s avatar`;
                userName.textContent = user.name || user.login;
                userLogin.textContent = `@${user.login}`;
                userProfile.href = user.html_url;
                userBio.textContent = user.bio || 'Пользователь не добавил биографию';
                reposCount.textContent = user.public_repos;
                followersCount.textContent = user.followers;
                followingCount.textContent = user.following;
            }

            // Функция для отображения репозиториев
            function displayRepos(repos) {
                if (repos.length === 0) {
                    reposList.innerHTML = '<p class="no-repos">У пользователя нет публичных репозиториев</p>';
                    return;
                }

                const reposHTML = repos.slice(0, 8).map(repo => createRepoElement(repo)).join('');
                reposList.innerHTML = reposHTML;
            }

            // Основная функция поиска
            async function searchUser() {
                const username = searchInput.value.trim();
                
                if (username === '') {
                    clearResults();
                    showInitialState();
                    clearSearch.style.display = 'none';
                    return;
                }

                clearSearch.style.display = 'flex';
                showLoading();

                try {
                    const [userResponse, reposResponse] = await Promise.all([
                        fetch(`https://api.github.com/users/${username}`),
                        fetch(`https://api.github.com/users/${username}/repos?sort=stars&per_page=8`)
                    ]);

                    if (!userResponse.ok) {
                        throw new Error('Пользователь не найден');
                    }

                    const userData = await userResponse.json();
                    const reposData = await reposResponse.json();

                    displayUser(userData);
                    displayRepos(reposData);
                    showResults();

                } catch (error) {
                    showError(error.message);
                } finally {
                    hideLoading();
                }
            }

            // Обработчики событий
            searchInput.addEventListener('input', debounce(searchUser));

            clearSearch.addEventListener('click', function() {
                searchInput.value = '';
                clearSearch.style.display = 'none';
                clearResults();
                showInitialState();
            });

            // Обработчики для примеров пользователей
            document.querySelectorAll('.example-user').forEach(element => {
                element.addEventListener('click', function() {
                    const username = this.getAttribute('data-user');
                    searchInput.value = username;
                    searchUser();
                });
            });

            // Фокус на поле ввода при загрузке
            searchInput.focus();
        });
    </script>
</body>
</html>